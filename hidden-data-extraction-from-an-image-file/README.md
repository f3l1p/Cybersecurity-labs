# Hidden Data Extraction from an Image File

**Author:** Carlos Felipe Chicangana  
**Category:** Digital Forensics / Steganography  
**Lab Environment:** Kali Linux, Windows Server 2012

---

## Introduction

The objective of this exercise is to document the process of identifying, extracting, and decoding hidden content embedded within an image file. The analysis was conducted against a vulnerable Windows Server 2012 lab, where the following image was accessed:  
http://192.168.200.9:8585/wordpress/wp-content/uploads/2016/09/graciosillo.png

The goal was to determine whether the image contained concealed data using forensic and steganographic techniques, and to successfully recover the hidden information.

---

## Scope

This exercise focuses exclusively on the forensic analysis of the file `graciosillo.png`, including:

- Detection of hidden or appended data
- Extraction of embedded files
- Decoding recovered content

Tools used during the analysis include strings, exiftool, binwalk, dd, and unzip.

---

## Methodology

### Initial Access

The Windows Server 2012 virtual machine was started and the image file was accessed through the web application. The file was downloaded locally for offline analysis to avoid rendering or executing potentially harmful content.

### Strings Analysis

The `strings` utility was used to search for readable ASCII text inside the image file. The output suggested the presence of non-random text fragments, indicating that additional data might be embedded within the file.

### Metadata Analysis

Metadata was analyzed using `exiftool`. A relevant warning was identified:  
Warning: [minor] Trailer data after PNG IEND chunk.  
This warning indicates that the file contains additional data after the mandatory PNG IEND chunk, a common technique used to hide appended content.

### Steganography Attempt

The tool `steghide` was tested to extract potential hidden data, but this attempt was unsuccessful, as `steghide` does not support PNG files and no valid password could be provided.

### Embedded File Detection

The analysis continued using `binwalk`, which identified an embedded ZIP archive starting at offset 0x4DE94 (decimal 319124). Automatic extraction was not successful.

### Manual File Extraction

Using the detected offset, a clean ZIP file was manually carved from the image using `dd`. The extracted archive was then decompressed, resulting in the recovery of a text file named `detuamigojohn.txt`.

### Content Decoding

The contents of `detuamigojohn.txt` appeared to be Base64-encoded. The data was decoded using a Base64 decoder. The decoded output resembled a Caesar cipher, which was successfully decrypted using an online decoding tool.

---

## Conclusion

The forensic analysis of the image file `graciosillo.png` revealed hidden data appended outside the standard PNG structure. The warning generated by `exiftool` provided a key indicator of concealed content. Using `binwalk`, an embedded ZIP archive was discovered at offset 0x4DE94. Manual extraction using `dd` and decompression with `unzip` allowed recovery of the hidden text file, which was subsequently decoded.

This exercise demonstrates the importance of understanding file formats, interpreting metadata correctly, and applying multiple forensic tools when analyzing seemingly harmless files.

---

## References

- PNG File Format Specification: https://www.libpng.org/pub/png/spec/1.2/PNG-Chunks.html
- Caesar Cipher Decoder: https://www.dcode.fr/caesar-cipher
- Kali Linux Documentation: https://www.kali.org/docs/
- Steghide Documentation: http://steghide.sourceforge.net/documentation.php
- ChatGPT (analysis and documentation assistance)

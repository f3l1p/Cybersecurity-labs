# Vulnerability Report – Metasploitable2

**Author:** Felipe Chicangana

---

## 1. Introduction

This report describes the main vulnerabilities present in the Metasploitable2 virtual machine and the techniques used to exploit them, both using the Metasploit Framework and through manual exploitation methods.  
Metasploitable2 is an intentionally vulnerable system designed for practicing penetration testing techniques in a controlled environment.

---

## 2. Vulnerable Services and Exploitation

### 2.1 VSFTPd 2.3.4 Backdoor

**Description**  
VSFTPd version 2.3.4 contains a built-in backdoor that allows remote command execution when a specially crafted username is used during authentication.

**Exploitation with Metasploit**  
The `exploit/unix/ftp/vsftpd_234_backdoor` module can be used to obtain a remote shell by configuring the target host and running the exploit.

**Manual Exploitation**  
The attacker connects to the FTP service on port 21 and attempts to authenticate using a username containing the string `:)`.  
This triggers the backdoor, opening a shell on port 6200, which can then be accessed to obtain remote command execution.

---

### 2.2 Samba (SMB) – Username Map Script

**Description**  
Samba version 3.0.20 is vulnerable to remote command execution through the misuse of the username map script functionality.

**Exploitation with Metasploit**  
The `exploit/multi/samba/usermap_script` module allows command execution by abusing this misconfiguration.

**Manual Exploitation**  
By connecting to a writable SMB share and injecting a malicious username string, arbitrary commands can be executed on the target system, resulting in a reverse shell.

---

### 2.3 Web Server (Apache)

#### 2.3.1 DVWA (Damn Vulnerable Web Application)

**Description**  
DVWA is an intentionally vulnerable web application designed to demonstrate common web security flaws.

**Main Vulnerabilities**
- SQL Injection  
- Cross-Site Scripting (XSS)  
- Command Injection  
- File Upload vulnerabilities  

**Exploitation with Metasploit**  
Metasploit auxiliary modules can be used to automate authentication and exploit SQL injection flaws.

**Manual Exploitation**  
Accessing the DVWA login page with default credentials (`admin/password`) allows exploitation of SQL Injection using payloads such as:  
`' OR '1'='1`

---

#### 2.3.2 phpMyAdmin

**Description**  
phpMyAdmin provides a web interface for managing MySQL databases and is often misconfigured with weak or default credentials.

**Exploitation with Metasploit**  
The `exploit/multi/http/phpmyadmin_preg_replace` module enables remote code execution in vulnerable configurations.

**Manual Exploitation**  
By accessing phpMyAdmin with default credentials (`root` with no password), attackers can execute malicious SQL queries and interact with the system.

---

### 2.4 Unreal IRCd

**Description**  
The Unreal IRC daemon included in Metasploitable2 contains a backdoor that allows remote command execution.

**Exploitation with Metasploit**  
The `exploit/unix/irc/unreal_ircd_3281_backdoor` module can be used to gain a shell.

**Manual Exploitation**  
By sending a crafted command to the IRC service, a reverse shell can be established to the attacker machine.

---

### 2.5 Distcc Daemon

**Description**  
The distcc service is vulnerable to unauthenticated remote command execution.

**Exploitation with Metasploit**  
The `exploit/unix/misc/distcc_exec` module allows execution of arbitrary commands.

**Manual Exploitation**  
Specially crafted distcc protocol messages can be sent to execute shell commands remotely.

---

### 2.6 PostgreSQL

**Description**  
The PostgreSQL service is configured with weak authentication credentials.

**Exploitation with Metasploit**  
The `exploit/linux/postgres/postgres_payload` module can be used with default credentials to obtain a shell.

**Manual Exploitation**  
Logging in with the default `postgres` user allows execution of SQL commands that can interact with the underlying operating system.

---

### 2.7 SSH – Weak Credentials

**Description**  
The SSH service contains multiple user accounts with weak or default passwords.

**Exploitation with Metasploit**  
Brute-force attacks can be performed using SSH scanner modules and wordlists.

**Manual Exploitation**  
Common credentials such as `msfadmin:msfadmin` or `user:user` allow direct SSH access.

---

### 2.8 Apache Tomcat

**Description**  
The Apache Tomcat server exposes its management interface using default credentials.

**Exploitation with Metasploit**  
The `exploit/multi/http/tomcat_mgr_deploy` module can deploy a malicious WAR file.

**Manual Exploitation**  
By logging into the Tomcat Manager with default credentials (`tomcat/tomcat`), a malicious application can be uploaded to gain code execution.

---

## 3. Privilege Escalation

### 3.1 Vulnerable Kernel

**Description**  
The Linux kernel used in Metasploitable2 is outdated and vulnerable to known local privilege escalation exploits.

**Exploitation**  
Both Metasploit modules and publicly available kernel exploits can be used to escalate privileges to root.

---

## 4. Enumeration

### 4.1 Port Scanning

Port scanning is performed to identify open ports, running services, and service versions, helping to map the attack surface.

### 4.2 Service Enumeration

Metasploit auxiliary scanners are used to gather detailed information about services such as SSH, SMB, and UDP-based services.

---

## 5. Security Recommendations

- Keep all services and applications updated  
- Enforce strong password policies and disable default credentials  
- Harden exposed services and disable unnecessary ones  
- Implement monitoring and intrusion detection systems  
- Segment networks using firewalls and VLANs  
- Apply regular operating system and kernel patches  

---

## 6. Conclusion

Metasploitable2 contains numerous intentionally vulnerable services that enable hands-on practice of real-world penetration testing techniques.  
This report highlights common vulnerabilities and demonstrates both automated and manual exploitation methods, reinforcing the importance of secure configuration, patch management, and strong authentication in production environments.
